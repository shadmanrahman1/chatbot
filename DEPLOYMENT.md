# ðŸš€ Railway Deployment Guide

## Your Actual Environment Variables for Railway

**Copy these EXACT values into Railway Dashboard â†’ Your Web Service â†’ Variables:**

```bash
# Meta WhatsApp Business API - REQUIRED
WHATSAPP_TOKEN=your_meta_access_token_here
PHONE_NUMBER_ID=your_phone_number_id_here
VERIFY_TOKEN=your_verify_token_here
API_VERSION=v22.0
APP_ID=your_app_id_here

# AI Configuration - RECOMMENDED
GROQ_API_KEY=your_groq_api_key_here

# Note: See RAILWAY_KEYS.md for your actual values

# Optional (if you get app secret from Meta)
APP_SECRET=your_app_secret_here
```

## Step-by-Step Deployment

### 1. Push to GitHub
```powershell
cd f:\Skill_WORK\CODE\Whatsapp_bot\whatsapp-bot-railway
git init
git add .
git commit -m "WhatsApp bot for Railway deployment"
git branch -M main
git remote add origin https://github.com/yourusername/whatsapp-bot-railway.git
git push -u origin main
```

### 2. Deploy on Railway
1. **Go to [Railway.app](https://railway.app/)**
2. **"Deploy from GitHub repo"** â†’ Select `whatsapp-bot-railway`
3. **Add MySQL Database:** 
   - Click "Add Service" â†’ "Database" â†’ "MySQL"
   - Wait for MySQL to provision (gets its own URL)

### 3. Configure Variables
**In Railway Dashboard â†’ Web Service â†’ Variables â†’ Add all variables above**

**Important:** Railway MySQL will automatically create a `DATABASE_URL` - don't override it.

### 4. Verify Deployment
- Railway will auto-deploy after variables are set
- Check logs for "âœ… Initialization complete"
- Visit: `https://your-app-name.up.railway.app/health`
- Should show: `{"status": "healthy", "database": "connected"}`

### 5. Seed Database
**Option A: Railway Console**
1. MySQL Service â†’ "Connect" â†’ Use SQL editor
2. Copy-paste the CREATE TABLE and INSERT statements from `seed_database.py`

**Option B: Remote Script**
1. Get MySQL connection details from Railway
2. Update `DATABASE_URL` in `.env` 
3. Run: `python seed_database.py`

### 6. Configure Meta Webhook
1. **Meta Developer Console â†’ WhatsApp â†’ Configuration**
2. **Callback URL:** `https://your-app-name.up.railway.app/webhook`
3. **Verify Token:** `my_secure_webhook_token_2024` (exact match)
4. **Subscribe to:** `messages`
5. **Click "Verify and Save"**

## Test Your Bot

### Send Test Message
- Send "hello" to your WhatsApp Business number: `+8801883429322`
- Should get course listing and welcome message
- Check Railway logs for message processing

### API Tests
```bash
# Health check
curl https://your-app-name.up.railway.app/health

# Test message processing
curl -X POST https://your-app-name.up.railway.app/test \
  -H "Content-Type: application/json" \
  -d '{"message": "python course", "number": "1234567890"}'
```

## Troubleshooting

### Webhook Verification Fails
- Ensure `VERIFY_TOKEN` is exactly: `my_secure_webhook_token_2024`
- Check Railway logs during verification attempt
- Test URL: `curl "https://your-app.up.railway.app/webhook?hub.mode=subscribe&hub.verify_token=my_secure_webhook_token_2024&hub.challenge=test"`

### Database Issues
- Check Railway MySQL service is running (green status)
- Verify `DATABASE_URL` is auto-generated by Railway
- Test connection: visit `/health` endpoint

### Message Not Processing
- Check Railway logs for webhook POST requests
- Verify Meta webhook subscription is active
- Test with `/test` endpoint first

## Your Setup Summary

âœ… **Phone Number:** +8801883429322  
âœ… **WhatsApp Link:** https://wa.me/8801883429322?text=Start  
âœ… **Meta Phone ID:** 765226423345284  
âœ… **Meta App ID:** 2524021141303698  
âœ… **Verify Token:** my_secure_webhook_token_2024  
âœ… **AI Model:** Groq (llama-3.1-8b-instant)  

## Next Steps After Deployment

1. **Test thoroughly** with various message types
2. **Get production WhatsApp token** (current is temporary)
3. **Add APP_SECRET** for enhanced security
4. **Monitor Railway usage** to stay within free limits
5. **Consider upgrading** if traffic increases

Ready to deploy? Follow the steps above and your bot will be live! ðŸš€
